name 'pam'
org 'amylum'

licenses 'COPYING'

deps(
  libtirpc: {
    version: '1.0.2-2',
    checksum: '8bb815b32a2b779e2059a560eea1a4526817720fcf0e1aa78d22d8e90618e36b'
  },
  krb5: {
    version: '1.15.1-1',
    checksum: 'edf36e1eefe1d581e84efc7f7038389024a35fdf1da07c7f56b3d0ef6c19a8ba'
  },
  openssl: {
    version: '1.0.2l-1',
    checksum: '6a46a1a65aa5cadc69a2b01e3ef8fa0a38353f3f7b86c1a772ab5156dd5b2264'
  }
)

configure_flags(
  prefix: '/usr',
  sbindir: '/usr/bin',
  sysconfdir: '/etc',
  libdir: '/usr/lib',
  'enable-regenerate-docu': nil
)

cflags
cflags ['-L/usr/lib/musl/lib']
harden

patch 'fix-compat.patch'
patch 'musl-fix-pam_exec.patch'
patch 'pam_rhosts_fix.patch'

build do
  run './autogen.sh'
  configure
  make
  install
end

test do
  # TODO: add tests
end
