name 'pam'
org 'amylum'

licenses 'COPYING'

deps(
  libtirpc: {
    version: '1.0.3-6',
    checksum: '7a1006a2a95d55550d8dab60fa8a8fc53df8d5069dfde0f901e9af2a55e7044d'
  },
  krb5: {
    version: '1.16.1-1',
    checksum: '4538754807eedb74cdde85e804142226ba577e346dd48768e1a824720eb3a412'
  },
  openssl: {
    version: '1.1.0i-1',
    checksum: '62004bc61c94107134eb16fdb405b36df2246f303bcd58f5d7df87025a6d7804'
  }
)

configure_flags(
  prefix: '/usr',
  sbindir: '/usr/bin',
  sysconfdir: '/etc',
  libdir: '/usr/lib',
  'enable-regenerate-docu': nil
)

cflags
cflags ['-L/usr/lib/musl/lib']
harden

patch 'fix-compat.patch'
patch 'musl-fix-pam_exec.patch'
patch 'pam_rhosts_fix.patch'

build do
  run './autogen.sh'
  configure
  make
  install
end

test do
  # TODO: add tests
end
